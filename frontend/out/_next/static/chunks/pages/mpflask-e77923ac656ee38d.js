(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[272],{2768:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>n});var o=t(7876),a=t(4232);function n(){let[e,r]=(0,a.useState)(""),[t,n]=(0,a.useState)(""),[s,c]=(0,a.useState)(""),[l,i]=(0,a.useState)(""),[p,h]=(0,a.useState)([]),[d,u]=(0,a.useState)(!1),j=(0,a.useRef)(null),m=async r=>{r.preventDefault();try{let r,t=await fetch("http://localhost:6767/api/create_quiz",{method:"POST",headers:{"X-Key":e,"Content-Type":"application/json",Accept:"application/json"},mode:"cors"});try{r=await t.json()}catch(r){console.error("Failed to parse JSON:",r);let e=await t.text();console.error("Response text:",e),n("Error parsing server response");return}console.log(r),t.ok?n("Successfully created game with ID ".concat(r.sessionID)):n("Error creating game")}catch(e){n("Error connecting to server"),console.error("Error:",e)}},y=()=>{j.current&&clearInterval(j.current),j.current=setInterval(async()=>{try{let e,r=await fetch("http://localhost:6767/api/game_info",{method:"GET",headers:{"X-Key":s,Accept:"application/json"},mode:"cors"});if(!r.ok)return void console.error("Failed to fetch game info");try{e=await r.json()}catch(e){console.error("Failed to parse JSON:",e);return}console.log(e),e.players?h(e.players):e.data&&e.data.players&&h(e.data.players)}catch(e){console.error("Error polling game info:",e)}},500)},x=async e=>{e.preventDefault();try{let e=await fetch("http://localhost:6767/api/join_game",{method:"POST",headers:{"X-Key":s,"X-Player-Name":l,"Content-Type":"application/json",Accept:"application/json"},mode:"cors"});try{await e.json()}catch(t){console.error("Failed to parse JSON:",t);let r=await e.text();console.error("Response text:",r),n("Error parsing server response");return}e.ok?(n("Successfully joined game with ID ".concat(s," as ").concat(l)),u(!0),y()):n("Error joining game")}catch(e){n("Error connecting to server"),console.error("Error:",e)}},g=async()=>{try{let e=await fetch("http://localhost:6767/api/start_game",{method:"POST",headers:{"X-Key":s,"Content-Type":"application/json",Accept:"application/json"},mode:"cors"});console.log(e.ok);try{await e.json()}catch(t){console.error("Failed to parse JSON:",t);let r=await e.text();console.error("Response text:",r),n("Error parsing server response");return}e.ok?(n("Game has started!"),y()):n("Error starting game")}catch(e){n("Error connecting to server"),console.error("Error:",e)}};return(0,a.useEffect)(()=>()=>{j.current&&clearInterval(j.current)},[]),(0,o.jsxs)("div",{style:{padding:"20px"},children:[!d&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h1",{children:"Create Game"}),(0,o.jsxs)("form",{onSubmit:m,children:[(0,o.jsx)("div",{children:(0,o.jsxs)("label",{children:["Question Bank ID:",(0,o.jsx)("input",{type:"text",value:e,onChange:e=>r(e.target.value),required:!0})]})}),(0,o.jsx)("button",{type:"submit",children:"Create Game"})]}),(0,o.jsx)("h1",{children:"Join Game"}),(0,o.jsxs)("form",{onSubmit:x,children:[(0,o.jsx)("div",{children:(0,o.jsxs)("label",{children:["Session ID:",(0,o.jsx)("input",{type:"text",value:s,onChange:e=>c(e.target.value),required:!0})]})}),(0,o.jsx)("div",{children:(0,o.jsxs)("label",{children:["Player Name:",(0,o.jsx)("input",{type:"text",value:l,onChange:e=>i(e.target.value),required:!0})]})}),(0,o.jsx)("button",{type:"submit",children:"Join Game"})]})]}),d&&(0,o.jsx)("button",{onClick:g,children:"Start Game"}),t&&(0,o.jsx)("p",{children:t}),p.length>0&&(0,o.jsxs)("div",{children:[(0,o.jsx)("h2",{children:"Players in Game:"}),(0,o.jsx)("ul",{children:p.map((e,r)=>(0,o.jsx)("li",{children:e},r))})]})]})}},7484:(e,r,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/mpflask",function(){return t(2768)}])}},e=>{e.O(0,[636,593,792],()=>e(e.s=7484)),_N_E=e.O()}]);