(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[63],{3086:(e,t,i)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile",function(){return i(9253)}])},9253:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>d});var a=i(7876),o=i(4232),n=i(8230),r=i.n(n),s=i(5364);function d(){let[e,t]=(0,o.useState)({displayName:"Learner",email:"",ownedDatasets:[],sharedDatasets:[],sharedWith:[]}),[i,n]=(0,o.useState)(!1),[d,l]=(0,o.useState)(!0),[c,p]=(0,o.useState)(""),[h,u]=(0,o.useState)(""),g="https://aristotle-api-env.eba-k2tqmvxk.us-east-1.elasticbeanstalk.com";async function m(e){l(!0),p("");try{let i=await fetch("".concat(g,"/api/profile"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}),a=await i.json();if(!i.ok||!a.ok){401===i.status?(localStorage.removeItem("idToken"),u(""),p("Not signed in. Please sign in to manage your profile.")):p(a.error||"Failed to load profile"),l(!1);return}t(e=>({...e,...a.data})),l(!1)}catch(e){p("Network error while loading profile"),l(!1)}}async function y(t){t.preventDefault(),n(!1),p("");let i=h||localStorage.getItem("idToken");if(!i)return void p("You must sign in before saving your profile");try{let t=await fetch("".concat(g,"/api/profile"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(i)},body:JSON.stringify(e)}),a=await t.json();if(!t.ok||!a.ok)return void(401===t.status?(localStorage.removeItem("idToken"),u(""),p("Not signed in. Please sign in again.")):p(a.error||"Failed to save profile"));n(!0),setTimeout(()=>n(!1),2e3)}catch(e){p("Network error while saving profile")}}async function f(){p("");let e=h||localStorage.getItem("idToken");try{let t=await fetch("".concat(g,"/api/create_checkout_session"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:e?"Bearer ".concat(e):void 0},body:JSON.stringify({})}),i=await t.json();if(!t.ok||!i.ok)return void p(i.error||"Failed to create checkout session");i.url?window.location.href=i.url:p("No checkout url returned")}catch(e){p("Network error creating checkout session")}}(0,o.useEffect)(()=>{try{let e=function(){if(!window.location.hash)return null;let e=new URLSearchParams(window.location.hash.replace(/^#/,""));return e.get("id_token")||e.get("access_token")}();e&&(localStorage.setItem("idToken",e),window&&window.history&&window.location&&window.history.replaceState({},document.title,window.location.pathname+window.location.search))}catch(e){}let e=localStorage.getItem("idToken");e?(u(e),m(e)):l(!1)},[]),e.displayName&&e.displayName[0]&&e.displayName[0].toUpperCase();let x=e.displayName&&e.displayName.trim()&&"Learner"!==e.displayName?e.displayName.trim()[0].toUpperCase():"A",b={maxWidth:760,margin:"0 auto",background:"#fff",padding:22,borderRadius:12,boxShadow:"0 8px 30px rgba(15,23,42,0.06)"},j={color:"#6b7280"};return(0,a.jsxs)("div",{style:{padding:28,fontFamily:"Inter, Arial, sans-serif",background:"#f6f8fb",minHeight:"75vh"},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:18,maxWidth:760,marginLeft:"auto",marginRight:"auto"},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{style:{margin:0,fontSize:28},children:"Your profile"}),(0,a.jsx)("div",{style:{...j,marginTop:6},children:"Manage your account and connected datasets"})]}),(0,a.jsx)("div",{children:(0,a.jsx)(r(),{href:"/app",style:{display:"inline-block",padding:"8px 12px",borderRadius:10,background:"#8B5CF6",color:"white",textDecoration:"none",fontWeight:600},children:"Back to app"})})]}),!h&&(0,a.jsxs)("div",{style:b,children:[(0,a.jsx)("h2",{style:{marginTop:0},children:"Sign in"}),(0,a.jsx)("p",{style:j,children:"You are not signed in. Use the Cognito hosted sign-in to authenticate."}),(0,a.jsxs)("div",{style:{display:"flex",gap:12,marginTop:12},children:[(0,a.jsx)("a",{href:function(){let e="us-east-1qv21sdjtw.auth.us-east-1.amazoncognito.com",t="6e5ub6489a8dvtaj41dfrq2u44",i="http://studyaristotle.com/callback",a=encodeURIComponent(s.env.NEXT_PUBLIC_COGNITO_SCOPES||"openid email profile");return e&&t&&i?"https://".concat(e,"/oauth2/authorize?response_type=token&client_id=").concat(t,"&redirect_uri=").concat(encodeURIComponent(i),"&scope=").concat(a):"#"}(),style:{padding:"10px 14px",background:"#2563EB",color:"white",borderRadius:10,textDecoration:"none",fontWeight:600},children:"Sign in with Cognito"}),(0,a.jsx)("button",{onClick:()=>{localStorage.removeItem("idToken"),u("")},style:{padding:"10px 14px",borderRadius:10,border:"1px solid #e6e9ef",background:"#fff"},children:"Clear token"})]}),(0,a.jsx)("div",{style:{marginTop:12,...j,fontSize:13},children:"After signing in you'll be returned here with a token stored locally. Make sure the environment variables NEXT_PUBLIC_COGNITO_DOMAIN, NEXT_PUBLIC_COGNITO_CLIENT_ID and NEXT_PUBLIC_COGNITO_REDIRECT_URI are set at build time."})]}),h&&(0,a.jsxs)("div",{style:{...b,border:e.is_premium?"2px solid #D4AF37":void 0,boxShadow:e.is_premium?"0 10px 34px rgba(212,175,55,0.12)":b.boxShadow},children:[(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:18},children:[(0,a.jsx)("div",{style:{width:88,height:88,borderRadius:999,background:e.is_premium?"linear-gradient(135deg,#FFD700,#FBBF24)":"linear-gradient(135deg,#8B5CF6,#06B6D4)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:36,fontWeight:800},children:x}),(0,a.jsxs)("div",{style:{flex:1},children:[(0,a.jsx)("div",{style:{fontSize:20,fontWeight:700},children:e.displayName}),(0,a.jsx)("div",{style:{...j},children:e.email||"No email set"})]}),(0,a.jsx)("div",{children:(0,a.jsx)("button",{onClick:function(){localStorage.removeItem("idToken"),u(""),t({displayName:"Learner",email:"",ownedDatasets:[],sharedDatasets:[],sharedWith:[]})},style:{padding:"8px 12px",borderRadius:10,border:"1px solid #e6eef",background:"#fff"},children:"Sign out"})})]}),e.is_premium&&(0,a.jsxs)("div",{style:{marginTop:12,display:"flex",alignItems:"center",gap:8},children:[(0,a.jsx)("div",{style:{background:"#F59E0B",color:"white",padding:"6px 10px",borderRadius:8,fontWeight:700},children:"Premium"}),(0,a.jsx)("div",{style:{color:"#6b7280"},children:"Thank you for supporting Aristotle â€” premium features unlocked."})]}),(0,a.jsxs)("form",{onSubmit:y,style:{display:"grid",gap:12,marginTop:18},children:[(0,a.jsxs)("label",{style:{display:"block"},children:[(0,a.jsx)("div",{style:{fontSize:13,color:"#111827",marginBottom:6},children:"Display name"}),(0,a.jsx)("input",{value:e.displayName,onChange:e=>t(t=>({...t,displayName:e.target.value})),style:{width:"100%",padding:12,borderRadius:10,border:"1px solid #e6e9ef"}})]}),(0,a.jsxs)("label",{style:{display:"block"},children:[(0,a.jsx)("div",{style:{fontSize:13,color:"#111827",marginBottom:6},children:"Email"}),(0,a.jsx)("input",{value:e.email,onChange:e=>t(t=>({...t,email:e.target.value})),placeholder:"you@example.com",style:{width:"100%",padding:12,borderRadius:10,border:"1px solid #e6e9ef"}})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{fontSize:13,color:"#111827",marginBottom:8},children:"Owned datasets"}),Array.isArray(e.ownedDatasets)&&e.ownedDatasets.length>0?(0,a.jsx)("ul",{style:{margin:0,paddingLeft:18},children:e.ownedDatasets.map((e,t)=>(0,a.jsx)("li",{children:(0,a.jsx)("code",{style:{background:"#f3f4f6",padding:"2px 6px",borderRadius:6},children:e})},t))}):(0,a.jsx)("div",{style:{color:"#6b7280"},children:"No owned datasets"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{fontSize:13,color:"#111827",marginBottom:8},children:"Shared datasets"}),Array.isArray(e.sharedDatasets)&&e.sharedDatasets.length>0?(0,a.jsx)("ul",{style:{margin:0,paddingLeft:18},children:e.sharedDatasets.map((e,t)=>(0,a.jsx)("li",{children:(0,a.jsx)("code",{style:{background:"#f3f4f6",padding:"2px 6px",borderRadius:6},children:e})},t))}):(0,a.jsx)("div",{style:{color:"#6b7280"},children:"No shared datasets"})]}),(0,a.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,a.jsx)("button",{type:"submit",style:{padding:"10px 14px",background:"#8B5CF6",color:"white",border:"none",borderRadius:10,cursor:"pointer",fontWeight:600},children:"Save"}),(0,a.jsx)("button",{onClick:f,type:"button",style:{padding:"10px 14px",background:"#06B6D4",color:"white",border:"none",borderRadius:10,cursor:"pointer",fontWeight:600},children:"Go Premium"}),i&&(0,a.jsx)("span",{style:{color:"#16a34a"},children:"Saved"}),d&&(0,a.jsx)("span",{style:{color:"#6b7280"},children:"Loading..."})]}),c&&(0,a.jsx)("div",{style:{color:"crimson"},children:c})]})]}),!h&&!d&&(0,a.jsx)("div",{style:{maxWidth:760,margin:"18px auto 0",...j},children:"If you already signed in but the page still shows signed-out, try clearing tokens or reloading the app."})]})}}},e=>{e.O(0,[636,593,792],()=>e(e.s=3086)),_N_E=e.O()}]);